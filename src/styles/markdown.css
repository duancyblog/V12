.custom-md {
    h1 {
        @apply text-3xl;
    }

    h1, h2, h3, h4, h5, h6 {
        .anchor {
            @apply transition -m-0.5 ml-[0.2ch] p-0.5 select-none opacity-0 no-underline !important;

            .anchor-icon {
                @apply mx-[0.45ch] !important;
            }
        }

        &:hover {
            .anchor {
                @apply opacity-100 !important;
            }
        }
    }

    a:not(.no-styling) {
        @apply relative bg-none transition transition rounded-md p-1 -m-1 font-medium text-[var(--primary)]
        underline decoration-[var(--link-underline)] decoration-1 decoration-dashed underline-offset-4
        before:ease-out before:transition active:bg-none hover:before:bg-[var(--btn-plain-bg-hover)] active:before:bg-[var(--btn-plain-bg-active)] z-0
        before:absolute before:rounded-[inherit] before:inset-0 before:scale-[0.85] hover:before:scale-100 before:-z-10;
        box-decoration-break: clone;
        -webkit-box-decoration-break: clone;
    
        &:hover, &:active {
            @apply decoration-transparent;
            background: var(--btn-plain-bg-hover);
            border-bottom: 1px dashed var(--link-hover);
            text-decoration: none;
        }

        /* External link icon styles */
        .external-link-icon {
            @apply inline-block ml-1 opacity-60 transition-opacity;
            vertical-align: text-top;
        }

        &:hover .external-link-icon {
            @apply opacity-100;
        }
    }
}

code {
    @apply bg-[var(--inline-code-bg)] text-[var(--inline-code-color)] px-1 py-0.5 rounded-md overflow-hidden;
    font-family: 'JetBrains Mono Variable', ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace;
    
    &:before, &:after {
        content: none;
    }

    counter-reset: line;
    
    span.line {
        &:before {
            @apply text-white/25 mr-4 w-4 inline-block;
            content: counter(line);
            counter-increment: line;
            direction: rtl;
        }
        
        &:last-child:empty, &:last-child:has(> span:empty:only-child) {
            display: none;
        }
    }
}

/* 代码块容器容器样式优化 */
.frame {
    @apply relative rounded-lg overflow-hidden transition-all duration-300;
    
    &:hover {
        @apply shadow-lg;
    }
}

.copy-btn {
    all: initial;
    @apply absolute top-2 right-2 z-10 w-8 h-8 rounded-md bg-gray-800/80 hover:bg-gray-700 transition-all duration-200 opacity-0 cursor-pointer flex items-center justify-center;
    
    &:active {
        @apply scale-90;
    }
}

.frame:hover .copy-btn {
    opacity: 1;
}

.copy-btn-icon {
    @apply absolute top-1/2 left-1/2 transition -translate-x-1/2 -translate-y-1/2 w-4 h-4 fill-white pointer-events-none;
}

.copy-btn .copy-icon {
    @apply opacity-100 fill-white dark:fill-white/75;
}

.copy-btn.success .copy-icon {
    @apply opacity-0 fill-[var(--deep-text)];
}

.copy-btn .success-icon {
    @apply opacity-0 fill-white;
}

.copy-btn.success .success-icon {
    @apply opacity-100;
}

/* 代码块标题样式 */
.code-title {
    @apply bg-gray-800 text-white px-4 py-2 text-sm font-medium border-b border-gray-700;
}

/* 代码 diff 样式增强 */
pre code .line--inserted {
    @apply bg-green-500/10 border-l-4 border-green-500;
}

pre code .line--deleted {
    @apply bg-red-500/10 border-l-4 border-red-500;
}

pre code .highlighted {
    @apply bg-yellow-500/20;
}
